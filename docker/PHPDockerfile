FROM webdevops/php:8.3

ENV COMPOSER_ALLOW_SUPERUSER 1
ENV COMPOSER_HOME /tmp

ARG APPLICATION_UID_OVERRIDE=1000
ARG APPLICATION_GID_OVERRIDE=1000

RUN echo "Change uid/gid of 'application' user (${APPLICATION_UID_OVERRIDE}:${APPLICATION_GID_OVERRIDE})" && \
    usermod -u ${APPLICATION_UID_OVERRIDE} application && \
    groupmod -g ${APPLICATION_GID_OVERRIDE} application && \
    usermod -g ${APPLICATION_GID_OVERRIDE} application &&     \
    chown "$APPLICATION_USER":"$APPLICATION_GROUP" -R /app /home/application
